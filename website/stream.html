<!DOCTYPE html>
<html lang="en">
  <head>

    <title>WCFM 91.9</title>

    <meta content="WCFM 91.9 Williamstown MA" name="WCFM website" />

    <!-- Setting character encoding and viewport size. -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- FavIcon (small image in tab), change to any image you want: -->
    <link href="favicon.ico" rel="icon" type="image/x-icon" />

    <!-- CSS: -->
    <!-- You will have to change this to "../style.css" if this HTML file is in a subfolder, to "../../style.css" if this HTML file is in 2 subfolders, etc. -->
    <link
  rel="stylesheet"
  href="https://unpkg.com/98.css">
    <link href="./style.css" rel="stylesheet" />
    
    <!-- JavaScript: -->
    <!-- You will have to change this to "../layout.js" if this HTML file is in a subfolder, to "../../layout.js" if this HTML file is in 2 subfolders, etc. -->
    <script src="./layout.js"></script>
<script src="https://iframe.chat/scripts/main.min.js"></script>
    <script>
      // Template generated with petrapixel's layout generator.
      // (Please do not remove this credit.)
      console.log("%cTemplate generated with petrapixel's layout generator: https://petrapixel.neocities.org/coding/layout-generator", "font-size: 14pt; color: #922a45; background: #ffd3ef");
    </script>
  </head>
  <script>
// initiate variables
  let track_name;

  let playpause_btn;
  let next_btn;
  let prev_btn;

  let seek_slider;
  let curr_time;
  let total_duration;

  let track_index;
  let isPlaying;
  let updateTimer;

  // create new audio element
  let curr_track;

  //
  // DEFINE YOUR SONGS HERE!!!!!
  // MORE THAN FOUR SONGS CAN BE ADDED!!
  // JUST ADD ANOTHER BRACKET WITH NAME AND PATH
  // CATBOX.MOE IS RECOMMENDED FOR UPLOADING MP3 FILES
  let track_list;
  //
  //
  //
  //
  //

  document.addEventListener("DOMContentLoaded", function () {
  track_name = document.querySelector(".songtitle");

  playpause_btn = document.querySelector(".playpause-track");
  next_btn = document.querySelector(".next-track");
  prev_btn = document.querySelector(".prev-track");

  seek_slider = document.querySelector(".seek_slider");
  curr_time = document.querySelector(".current-time");
  total_duration = document.querySelector(".total-duration");

  track_index = 0;
  isPlaying = false;
  updateTimer;

  // create new audio element
  curr_track = document.getElementById("music");

  //
  // DEFINE YOUR SONGS HERE!!!!!
  // MORE THAN FOUR SONGS CAN BE ADDED!!
  // JUST ADD ANOTHER BRACKET WITH NAME AND PATH
  // CATBOX.MOE IS RECOMMENDED FOR UPLOADING MP3 FILES
  track_list = [
      {
          name:"WCFM 91.9",
          path:"http://wcfm-streaming.williams.edu:8000/stream"
      }
  ];
  loadTrack(track_index);
});

  function loadTrack(track_index) {
      clearInterval(updateTimer);
      resetValues();

      // load a new track
      curr_track.src = track_list[track_index].path;
      curr_track.load();

      // update details of the track
      track_name.textContent = "playing " + (track_index + 1) + " of " + track_list.length + ": " + track_list[track_index].name;

      // set an interval of 1000 milliseconds for updating the seek slider
      updateTimer = setInterval(seekUpdate, 1000);

      // move to the next track if the current one finishes playing 
      curr_track.addEventListener("ended", nextTrack);
  }

  // reset values
  function resetValues() {
      curr_time.textContent = "0:00";
      total_duration.textContent = "0:00";
      seek_slider.value = 0;
  }

  // checks if song is playing
  function playpauseTrack() {
      if (!isPlaying) playTrack();
      else pauseTrack();
  }

  // plays track when play button is pressed
  function playTrack() {
      curr_track.play();
      isPlaying = true;

      // replace icon with the pause icon
      playpause_btn.innerHTML = '<button><img src="https://i.imgur.com/xfIvKgS.png" class="controlimg"></i></button>';
  }

  // pauses track when pause button is pressed
  function pauseTrack() {
      curr_track.pause();
      isPlaying = false;

      // replace icon with the play icon
      playpause_btn.innerHTML = '<button><img src="https://i.imgur.com/lvaNTua.png" class="controlimg"></button>';
  }

  // moves to the next track
  function nextTrack() {
      if (track_index < track_list.length - 1)
          track_index += 1;
      else track_index = 0;
      loadTrack(track_index);
      playTrack();
  }

  // moves to the previous track
  function prevTrack() {
      if (track_index > 0)
          track_index -= 1;
      else track_index = track_list.length;
      loadTrack(track_index);
      playTrack();
  }

  // seeker slider
  function seekTo() {
      seekto = curr_track.duration * (seek_slider.value / 100);
      curr_track.currentTime = seekto;
  }

  function seekUpdate() {
      let seekPosition = 0;

      // check if the current track duration is a legible number
      if (!isNaN(curr_track.duration)) {
          seekPosition = curr_track.currentTime * (100 / curr_track.duration);
          seek_slider.value = seekPosition;

      // calculate the time left and the total duration
      let currentMinutes = Math.floor(curr_track.currentTime / 60);
      let currentSeconds = Math.floor(curr_track.currentTime - currentMinutes * 60);
      let durationMinutes = Math.floor(curr_track.duration / 60);
      let durationSeconds = Math.floor(curr_track.duration - durationMinutes * 60);

      // adding a zero to the single digit time values
      if (currentSeconds < 10) { currentSeconds = "0" + currentSeconds; }
      if (durationSeconds < 10) { durationSeconds = "0" + durationSeconds; }
      if (currentMinutes < 10) { currentMinutes = currentMinutes; }
      if (durationMinutes < 10) { durationMinutes = durationMinutes; }

      curr_time.textContent = currentMinutes + ":" + currentSeconds;
      total_duration.textContent = durationMinutes + ":" + durationSeconds;
    }
  }

  // load the first track in the tracklist

  </script>
  <body>
    <!-- The next line is a skip-to-content link for keyboard users. Do not remove it! -->
    <a href="#content" id="skip-to-content-link">Skip to content</a>

    <div class="layout">
      
      <!-- =============================================== -->
      <!-- Header (and Sidebars) will be loaded per JavaScript! Edit layout.js to change. -->
      <!-- =============================================== -->

  
      <main id="content" style="padding:0; border:none;max-height:900px;"> <!-- Do NOT remove the ID here -->

        <noscript>Please enable JavaScript to view this website!</noscript>

        <!-- =============================================== -->
        <!-- MAIN CONTENT -->
        <!-- =============================================== -->


        <section style="padding-bottom:10px;">
        <div class="window" style="width:100%;max-height:inherit;overflow-y:auto;">
          <div class="title-bar">
            <div class="title-bar-text">listen to wcfm	(o_ _)ﾉ彡☆</div>
            <div class="title-bar-controls">
              <button aria-label="Minimize"></button>
              <button aria-label="Maximize"></button>
              <button aria-label="Close"></button>
            </div>
          </div>
          <div class="window-body" style="max-height:inherit;">
            <div class="player">
              <div class="window">
                <div class="title-bar">
                  <div class="title-bar-text"><sub><img class="titlebaricon" src="https://i.imgur.com/5r8E7vB.png" alt=""></sub> CD player</div>
                  <div class="title-bar-controls">
                    <button aria-label="Minimize"></button>
                    <button aria-label="Maximize"></button>
                    <button aria-label="Close"></button>
                  </div>
                </div>
                <div class="window-body">
                  <div class="flex">
              <div id="imagestyle"><img class="ic" src="wcfm_photos/batch 1 0012.png" alt=""></div>
                  <div id="musicplayer">
                      <div class="songtitlewindow">
                          <div class="flex"><marquee scrollamount="1" class="songtitle"></marquee><div class="songtitlearrow"></div></div>
                      </div>
               
               <div class="seeking">
                          <div class="current-time">00:00</div>
               
                          <input type="range" min="1" max="100" value="0" class="seek_slider" onchange="seekTo()">
               
                          <div class="total-duration">0:00</div>
                      </div>
               
                      <table class="controls">
                          <tr>
                              <td>
                                  <div class="prev-track" onclick=""><button><img src="https://i.imgur.com/smNRLfT.png" class="controlimg"></button></div>
                              </td>
                              <td>
                                  <div class="playpause-track" onclick="playpauseTrack()" ><button><img src="https://i.imgur.com/lvaNTua.png" class="controlimg"></button></div>
                              </td>
                              <td>
                                  <div class="next-track" onclick="#"><button><img src="https://i.imgur.com/ihIsZGK.png" class="controlimg"></button></div>
                              </td>
                          </tr>
                      </table>
               
                      <audio id="music" src=""></audio> 
                  </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section style="padding-bottom: 10px;">
        <div class="window" style="width:100%;max-height:inherit;overflow-y:auto;">
          <div class="title-bar">
            <div class="title-bar-text">alternatively...</div>
            <div class="title-bar-controls">
              <button aria-label="Minimize"></button>
              <button aria-label="Maximize"></button>
              <button aria-label="Close"></button>
            </div>
          </div>
          <div class="window-body" style="max-height:inherit;">

            <a href="http://wcfm-streaming.williams.edu:8000/stream" target="_blank"><h1>listen in your browser</h1></a>
          </div>
        </div>

      </section>

       <section style="padding-bottom:10px;">
        <div class="window" style="width:100%;">
          <div class="title-bar">
            <div class="title-bar-text">currently playing   °˖✧◝(⁰▿⁰)◜✧˖°</div>
            <div class="title-bar-controls">
              <button aria-label="Minimize"></button>
              <button aria-label="Maximize"></button>
              <button aria-label="Close"></button>
            </div>
          </div>
          <div class="window-body">
            <iframe style="border:none;" src="https://spinitron.com/widget/now-playing-v2?station=wcfm" allow="encrypted-media"></iframe>
          </div>
        </div>
       </section>
        
       <section style="height:100%;">
        <div class="window" style="width:100%;height:100%;">
          <div class="title-bar">
            <div class="title-bar-text">current / last show & playlist   °˖✧◝(⁰▿⁰)◜✧˖°</div>
            <div class="title-bar-controls">
              <button aria-label="Minimize"></button>
              <button aria-label="Maximize"></button>
              <button aria-label="Close"></button>
            </div>
          </div>
          <div class="window-body" style="height:100%; width:100%;">
            <iframe style="border:none; width:100%;height:100%;" src="https://spinitron.com/widget/current-playlist?station=wcfm" allow="encrypted-media"></iframe>
          </div>
        </div>
       </section>
      </main>
      
      <!-- =============================================== -->
      <!-- Footer will be loaded per JavaScript! Edit layout.js to change. -->
      <!-- =============================================== -->

  
    <!-- Closing .layout: -->
    </div>


    <!-- Add any additional Javascript code (<script></script>) here. -->
  </body>
</html>
